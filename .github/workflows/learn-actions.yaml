name: learn-actions
run-name: ${{ github.actor }} is learning GitHub Actions
on: [push]
jobs:
  echo-message:
    runs-on: ubuntu-latest
    steps:
      - name: print hello
        run: echo "Hello from echo-messages" > ~/hello.txt
      - name: cache test message
        id: cache-message
        uses: actions/cache@v3
        with:
          # npm cache files are stored in `~/.npm` on Linux/macOS
          path: ~/hello.txt
          key: ${{ github.ref_name }}-build-${{ github.run_number }}-${{ github.run_attempt }}
      - name: sleep for 5s
        run: sleep 5s
  temp-job-2:
    needs: echo-message
    runs-on: ubuntu-latest
    steps:
      - name: get cache message
        id: cache-message
        uses: actions/cache@v3
        with:
          # npm cache files are stored in `~/.npm` on Linux/macOS
          path: ~/hello.txt
          key: ${{ github.ref_name }}-build-${{ github.run_number }}-${{ github.run_attempt }}
      - name: print cache message
        run: cat ~/hello.txt
  temp-job-3:
    needs: echo-message
    runs-on: ubuntu-latest
    steps:
      - name: print hello
        run: echo "Hello job 3"
  cleanup-job:
    needs: [ temp-job-2, temp-job-3 ]
    if: ${{ always() }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: install gh cache extention
        env:
          GH_TOKEN: ${{ github.token }}
        run:  gh extension install actions/gh-actions-cache
      - name: list extensions
        run: gh extension list
      - name: list cache
        run: gh actions-cache list --repo CradleKing24/misc-scripts
      - name: print hello
        run: echo "Hello cleanup"
